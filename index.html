<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Goonies Trip Treasure Map</title>

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    crossorigin=""
  ></script>

  <style>
    :root{
      --ink:#2a1d12;
      --paper:#f1e3c6;
      --paper2:#e8d3a8;
      --shadow: rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--ink);
      background: radial-gradient(1200px 700px at 20% 10%, #2b2b2b 0%, #121212 55%, #0b0b0b 100%);
    }
    .wrap{ max-width:1100px; margin:0 auto; padding:18px; }

    header{
      display:flex; align-items:flex-end; justify-content:space-between;
      gap:12px; margin-bottom:14px;
    }

    .title h1{ margin:0; font-size:clamp(22px,3vw,34px); }
    .title .sub{ font-size:14px; opacity:.9; margin-top:6px; }

    .btnrow{ display:flex; gap:10px; }
    button{
      border:0; padding:10px 12px; border-radius:12px;
      cursor:pointer; font-weight:900;
      box-shadow:0 8px 20px var(--shadow);
      background:linear-gradient(180deg,#f7e8c9,#e3cfa5);
    }
    button.secondary{
      background:linear-gradient(180deg,#1f1f1f,#121212);
      color:#f5e9d2;
    }

    .grid{ display:grid; grid-template-columns:1.4fr .6fr; gap:14px; }
    @media(max-width:920px){ .grid{ grid-template-columns:1fr; } }

    .card{
      border-radius:18px; overflow:hidden;
      box-shadow:0 18px 45px var(--shadow);
      border:1px solid rgba(255,255,255,.1);
    }

    .mapShell{
      background:
        radial-gradient(600px 320px at 20% 10%, rgba(255,255,255,.4), transparent 55%),
        linear-gradient(135deg,var(--paper),var(--paper2));
    }

    #map{ height:620px; width:100%; filter:sepia(.55) contrast(1.05); }
    @media(max-width:920px){ #map{ height:520px; } }

    .side{ background:linear-gradient(180deg,#f7ebd2,#e6d2ab); padding:14px; }

    .spot{
      padding:10px; border-radius:14px;
      background:rgba(255,255,255,.55);
      margin-bottom:10px; cursor:pointer;
      border:1px solid rgba(0,0,0,.1);
    }

    .spot.visited .name{
      text-decoration:line-through;
      text-decoration-thickness:3px;
      text-decoration-color:#8b1c1c;
    }

    .markerLabel{
      display:flex; align-items:center; justify-content:center;
      width:30px; height:30px; border-radius:10px;
      font-weight:900;
      box-shadow:0 10px 25px rgba(0,0,0,.25);
    }

    .markerTodo{ background:#111; color:#f7ebd2; }
    .markerDone{ background:#8b1c1c; color:#fff; }

    .modalBack{
      position:fixed; inset:0;
      background:rgba(0,0,0,.6);
      display:none; align-items:center; justify-content:center;
      z-index:9999;
    }

    .modal{
      background:linear-gradient(180deg,#f7ebd2,#e6d2ab);
      border-radius:18px;
      padding:20px;
      max-width:900px;
      width:90%;
    }

    .modal img{
      width:100%; border-radius:14px;
    }
  </style>
</head>

<body>
<div class="wrap">

<header>
  <div class="title">
    <h1>Goonies Trip Treasure Map</h1>
    <div class="sub">Click a pin to cross it off. Click Photo to view your uploaded image.</div>
  </div>
  <div class="btnrow">
    <button id="fitBtn" class="secondary">Fit Map</button>
    <button id="resetBtn">Reset</button>
  </div>
</header>

<div class="grid">
  <div class="card mapShell"><div id="map"></div></div>
  <div class="card side">
    <div id="spotList"></div>
  </div>
</div>

</div>

<div class="modalBack" id="modalBack">
  <div class="modal">
    <h2 id="modalTitle"></h2>
    <img id="modalImg" />
    <br><br>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>

const SPOTS = [
  {
    id:"oregon_film_museum",
    name:"Oregon Film Museum (County Jail)",
    meta:"732 Duane St, Astoria",
    lat:46.188499, lng:-123.835579,
    image:"CountyJail.jpg"
  },
  {
    id:"haystack_rock",
    name:"Haystack Rock",
    meta:"Cannon Beach",
    lat:45.88438, lng:-123.96841,
    image:"haystackrock.jpg"
  },
  {
    id:"lighthouse_lounge",
    name:"Lighthouse Lounge (set location area)",
    meta:"Ecola State Park area",
    lat:45.9310, lng:-123.9783,
    image:"LighthouseLounge.jpg"
  },
  {
    id:"lower_columbia_bowl",
    name:"Lower Columbia Bowl",
    meta:"826 Marine Dr, Astoria",
    lat:46.190063, lng:-123.834503,
    image:"bowlingalley.jpg"
  },
  {
    id:"goonies_house",
    name:"Goonies Main House",
    meta:"368 38th St, Astoria",
    lat:46.192848, lng:-123.799767,
    image:"house.jpg"
  },
  {
    id:"astoria_coffee_company",
    name:"Astoria Coffee Company Building",
    meta:"Leif Erikson Dr & 37th St",
    lat:46.193310, lng:-123.801842,
    image:"street.jpg"
  }
];


const STORAGE_KEY="goonies_crossed";
let crossed=JSON.parse(localStorage.getItem(STORAGE_KEY)||"{}");

const map=L.map("map");
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

function makeIcon(done){
  return L.divIcon({
    className:"",
    html:`<div class="markerLabel ${done?"markerDone":"markerTodo"}">${done?"✖":"✦"}</div>`,
    iconSize:[30,30],
    iconAnchor:[15,15]
  });
}

const bounds=[];

SPOTS.forEach(spot=>{
  const marker=L.marker([spot.lat,spot.lng],{
    icon:makeIcon(crossed[spot.id])
  }).addTo(map);

  bounds.push([spot.lat,spot.lng]);

  marker.on("click",()=>{
    crossed[spot.id]=!crossed[spot.id];
    localStorage.setItem(STORAGE_KEY,JSON.stringify(crossed));
    marker.setIcon(makeIcon(crossed[spot.id]));
    renderList();
  });

  marker.bindPopup(`
    <b>${spot.name}</b><br>
    ${spot.meta}<br><br>
    <button onclick="openPhoto('${spot.id}')">Photo</button>
  `);
});

map.fitBounds(bounds,{padding:[30,30]});

document.getElementById("fitBtn").onclick=()=>map.fitBounds(bounds,{padding:[30,30]});
document.getElementById("resetBtn").onclick=()=>{
  crossed={};
  localStorage.setItem(STORAGE_KEY,"{}");
  location.reload();
};

function renderList(){
  const list=document.getElementById("spotList");
  list.innerHTML="";
  SPOTS.forEach(spot=>{
    const div=document.createElement("div");
    div.className="spot"+(crossed[spot.id]?" visited":"");
    div.innerHTML=`
      <div class="name">${spot.name}</div>
      <div style="font-size:12px;opacity:.8;">${spot.meta}</div>
      <button onclick="openPhoto('${spot.id}')">Photo</button>
    `;
    list.appendChild(div);
  });
}
renderList();

function openPhoto(id){
  const spot=SPOTS.find(s=>s.id===id);
  document.getElementById("modalTitle").innerText=spot.name;
  document.getElementById("modalImg").src=spot.image;
  document.getElementById("modalBack").style.display="flex";
}

function closeModal(){
  document.getElementById("modalBack").style.display="none";
}

</script>
</body>
</html>
